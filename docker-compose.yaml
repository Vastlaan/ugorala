version: "3.3"

services:
    client:
        ports:
            - 3000:3000
        build:
            context: client
            dockerfile: Dockerfile
        image: noirfatale/ugorala-client
        volumes:
            - ./client:/usr/src/app
            - /usr/src/app/node_modules
            - /usr/src/app/.next
        environment: 
            - STRAPI_URL=http://strapi:1337

    strapi:
        image: noirfatale/ugorala-strapi
        env_file: 
            - .env-strapi
        build: 
            context: strapi
            dockerfile: Dockerfile
        volumes:
            - ./strapi:/usr/src/app
            - /usr/src/app/node_modules
        ports:
            - 1337:1337
    
    admin:
        image: noirfatale/ugorala-admin
        build: 
            context: admin
            dockerfile: Dockerfile
        volumes:
            - ./admin:/usr/src/app
            - /usr/src/app/node_modules
        ports:
            - 4000:3000
        env_file: 
            - .env-admin